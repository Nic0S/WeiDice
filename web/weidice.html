<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>WeiDice Frontend</title>
    <script language="javascript" type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="weidice_abi.js"></script>
    <script language="javascript" type="text/javascript" src="weidice.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
</head>

<body>
<label for="contract"> Contract Address:</label>
<input type="text" id="contract">
<div>
    <button onclick="connectAndReload().then(() => status('Connected.'))">Connect</button>
</div>
<p></p>
<div><label for="status">Status: </label>
    <p id="status"></p></div>
<p></p>

<div id="loggedIn" hidden>
    <div><label for="userBalance">User balance: </label>
        <p id="userBalance"></p></div>

    <label for="wager"> Wager (ETH):</label>
    <input type="number" id="wager" value="0.001">
    <p></p>
    <div>
        <button onclick="roll()">Roll!</button>
    </div>
    <p></p>
    <div><label for="contractBalance">Contract balance: </label>
        <p id="contractBalance"></p></div>
    <div><label for="events">Events: </label>
        <div id="events"></div>
    </div>
</div>
<script>
  function startApp() {
    const params = new URLSearchParams(window.location.search);
    $("#contract").val(params.get('contract'))
    status("Please click \"Connect\" to get started.")
  }
  
  window.addEventListener('load', function () {
    status("Starting...");
    if (typeof window.ethereum !== 'undefined') {
      web3 = new Web3(window.ethereum)
      startApp()
    } else {
      status("Please make sure metamask is installed and refresh the page.")
    }
  })
</script>
<script>
</script>
</body>
</html>